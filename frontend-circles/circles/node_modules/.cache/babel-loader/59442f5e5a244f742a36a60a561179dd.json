{"ast":null,"code":"var inherits = require('inherits');\n\nvar EventEmitter = require('events').EventEmitter;\n\nvar now = require('right-now');\n\nvar raf = require('raf');\n\nmodule.exports = Engine;\n\nfunction Engine(fn) {\n  if (!(this instanceof Engine)) return new Engine(fn);\n  this.running = false;\n  this.last = now();\n  this._frame = 0;\n  this._tick = this.tick.bind(this);\n  if (fn) this.on('tick', fn);\n}\n\ninherits(Engine, EventEmitter);\n\nEngine.prototype.start = function () {\n  if (this.running) return;\n  this.running = true;\n  this.last = now();\n  this._frame = raf(this._tick);\n  return this;\n};\n\nEngine.prototype.stop = function () {\n  this.running = false;\n  if (this._frame !== 0) raf.cancel(this._frame);\n  this._frame = 0;\n  return this;\n};\n\nEngine.prototype.tick = function () {\n  this._frame = raf(this._tick);\n  var time = now();\n  var dt = time - this.last;\n  this.emit('tick', dt);\n  this.last = time;\n};","map":null,"metadata":{},"sourceType":"script"}